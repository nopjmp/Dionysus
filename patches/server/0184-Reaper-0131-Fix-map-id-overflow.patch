From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: ruViolence <78062896+ruviolence@users.noreply.github.com>
Date: Sun, 16 Oct 2022 14:31:53 +0500
Subject: [PATCH] (Reaper 0131) Fix map id overflow

Co-authored-by: RemainingToast <remainingtoast@gmail.com>

diff --git a/src/main/java/net/minecraft/server/PersistentCollection.java b/src/main/java/net/minecraft/server/PersistentCollection.java
index 50056f49a8eaea687d00175e41a877040934e9ae..e7f1d7ee59c8920aca03872160ca1df7e07a7297 100644
--- a/src/main/java/net/minecraft/server/PersistentCollection.java
+++ b/src/main/java/net/minecraft/server/PersistentCollection.java
@@ -3,6 +3,8 @@ package net.minecraft.server;
 import com.destroystokyo.paper.exception.ServerInternalException;
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
+import dev.pomf.dionysus.DionysusLogger;
+
 import java.io.DataInputStream;
 import java.io.DataOutput;
 import java.io.DataOutputStream;
@@ -151,6 +153,7 @@ public class PersistentCollection {
             oshort = Short.valueOf((short) 0);
         } else {
             oshort = Short.valueOf((short) (oshort.shortValue() + 1));
+            oshort = (short) Math.abs(oshort); // Reaper - Fix map ID overflow // Dionysus - Math.abs
         }
 
         this.d.put(s, oshort);
